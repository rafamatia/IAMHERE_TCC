/******************************************************************************/
/***         Generated by IBExpert 2012.5.19.1 17/06/2019 21:39:42          ***/
/******************************************************************************/

SET SQL DIALECT 3;

SET NAMES NONE;

CREATE DATABASE 'C:\TCC\dados_banco\Banco\BANCO_MOD_2.FDB'
USER 'SYSDBA' PASSWORD 'masterkey'
PAGE_SIZE 16384
DEFAULT CHARACTER SET NONE COLLATION NONE;



/******************************************************************************/
/***                               Generators                               ***/
/******************************************************************************/

CREATE GENERATOR SEQ_ACADEMICO_GRADE;
SET GENERATOR SEQ_ACADEMICO_GRADE TO 9;

CREATE GENERATOR SEQ_CURSOS;
SET GENERATOR SEQ_CURSOS TO 0;

CREATE GENERATOR SEQ_DATA_VIGENCIA;
SET GENERATOR SEQ_DATA_VIGENCIA TO 0;

CREATE GENERATOR SEQ_DEPARTAMENTOS;
SET GENERATOR SEQ_DEPARTAMENTOS TO 0;

CREATE GENERATOR SEQ_DISCIPLINAS;
SET GENERATOR SEQ_DISCIPLINAS TO 0;

CREATE GENERATOR SEQ_GRADE_CURRICULAR;
SET GENERATOR SEQ_GRADE_CURRICULAR TO 5;

CREATE GENERATOR SEQ_HORARIOS;
SET GENERATOR SEQ_HORARIOS TO 0;

CREATE GENERATOR SEQ_PESSOAS;
SET GENERATOR SEQ_PESSOAS TO 0;

CREATE GENERATOR SEQ_PROFHORARIO;
SET GENERATOR SEQ_PROFHORARIO TO 0;



/******************************************************************************/
/***                                 Tables                                 ***/
/******************************************************************************/



CREATE TABLE ACADEMICO_GRADE (
    ACG_ID         INTEGER NOT NULL,
    ACG_ACADEMICO  VARCHAR(20) NOT NULL,
    ACG_GRADE      INTEGER NOT NULL,
    ACG_ANOLETIVO  INTEGER NOT NULL
);

CREATE TABLE CURSOS (
    CUR_CODIGO        INTEGER NOT NULL,
    CUR_NOME          VARCHAR(200) NOT NULL,
    CUR_DURACAO       INTEGER NOT NULL,
    CUR_TIPO_DURACAO  VARCHAR(1) DEFAULT 'A' NOT NULL,
    CUR_PERIODO       VARCHAR(1) DEFAULT 'N' NOT NULL,
    CUR_NIVEL         VARCHAR(1) DEFAULT 'G' NOT NULL,
    CUR_CARGAHORARIA  INTEGER NOT NULL,
    CUR_DEPARTAMENTO  INTEGER NOT NULL
);

CREATE TABLE DATA_VIGENCIA (
    DVG_ID         INTEGER NOT NULL,
    DVG_DT_INICIO  DATE NOT NULL,
    DVG_DT_FIM     DATE NOT NULL
);

CREATE TABLE DEPARTAMENTOS (
    DEP_CODIGO     INTEGER NOT NULL,
    DEP_DESCRICAO  VARCHAR(200) NOT NULL
);

CREATE TABLE DISCIPLINAS (
    DIS_CODIGO     INTEGER NOT NULL,
    DIS_DESCRICAO  VARCHAR(200) NOT NULL
);

CREATE TABLE GRADE_CURRICULAR (
    GRC_ID                   INTEGER NOT NULL,
    GRC_CURSO                INTEGER NOT NULL,
    GRC_DISCIPLINA           INTEGER NOT NULL,
    GRC_SERIE                INTEGER NOT NULL,
    GRC_DATAVIGENCIA         INTEGER NOT NULL,
    GRC_CARGAHORARIATOTAL    INTEGER NOT NULL,
    GRC_CARGAHORARIASEMANAL  INTEGER NOT NULL
);

CREATE TABLE HORARIOS (
    HOR_CODIGO       INTEGER NOT NULL,
    HOR_DESCRICAO    VARCHAR(200) NOT NULL,
    HOR_QTD_AULA     INTEGER DEFAULT 1 NOT NULL,
    HOR_ORDEM_AULA   INTEGER DEFAULT 1 NOT NULL,
    HOR_HORA_INICIO  TIME DEFAULT CURRENT_TIME NOT NULL,
    HOR_HORA_FIM     TIME DEFAULT CURRENT_TIME NOT NULL,
    HOR_DURACAO      TIME NOT NULL
);

CREATE TABLE PESSOAS (
    PES_CODIGO          INTEGER NOT NULL,
    PES_CPFCNPJ         VARCHAR(20) NOT NULL,
    PES_GENERO          VARCHAR(1) DEFAULT 'F' NOT NULL,
    PES_DATANASCIMENTO  DATE,
    PES_TIPOPESSOA      VARCHAR(1) DEFAULT 'F' NOT NULL,
    PES_NOMECOMPLETO    VARCHAR(60) NOT NULL
);

CREATE TABLE PROFESSOR_HORARIO (
    PFH_ID           INTEGER NOT NULL,
    PFH_PROFESSOR    VARCHAR(20) NOT NULL,
    PFH_GRADE        INTEGER NOT NULL,
    PFH_HORARIO      INTEGER NOT NULL,
    PFH_ANOLETIVO    INTEGER NOT NULL,
    PFH_DIADASEMANA  INTEGER DEFAULT 1 NOT NULL
);

CREATE TABLE SERIES (
    SER_ANO        INTEGER NOT NULL,
    SER_DESCRICAO  VARCHAR(30) NOT NULL
);



/******************************************************************************/
/***                           Unique Constraints                           ***/
/******************************************************************************/

ALTER TABLE ACADEMICO_GRADE ADD CONSTRAINT UK_ACADEMICOGRADE UNIQUE (ACG_ACADEMICO, ACG_GRADE, ACG_ANOLETIVO);
ALTER TABLE DATA_VIGENCIA ADD CONSTRAINT UK_DATA_VIGENCIA UNIQUE (DVG_DT_INICIO, DVG_DT_FIM);
ALTER TABLE GRADE_CURRICULAR ADD CONSTRAINT UK_GRADECURRICULAR UNIQUE (GRC_CURSO, GRC_DISCIPLINA, GRC_DATAVIGENCIA);
ALTER TABLE PROFESSOR_HORARIO ADD CONSTRAINT UK_PROFESSORHORARIO UNIQUE (PFH_PROFESSOR, PFH_HORARIO, PFH_ANOLETIVO, PFH_DIADASEMANA);


/******************************************************************************/
/***                              Primary Keys                              ***/
/******************************************************************************/

ALTER TABLE ACADEMICO_GRADE ADD CONSTRAINT PK_ACADEMICOGRADE PRIMARY KEY (ACG_ID);
ALTER TABLE CURSOS ADD CONSTRAINT PK_CURSOS PRIMARY KEY (CUR_CODIGO);
ALTER TABLE DATA_VIGENCIA ADD CONSTRAINT PK_DATA_VIGENCIA PRIMARY KEY (DVG_ID);
ALTER TABLE DEPARTAMENTOS ADD CONSTRAINT PK_DEPARTAMENTOS PRIMARY KEY (DEP_CODIGO);
ALTER TABLE DISCIPLINAS ADD CONSTRAINT PK_DISCIPLINAS PRIMARY KEY (DIS_CODIGO);
ALTER TABLE GRADE_CURRICULAR ADD CONSTRAINT PK_GRADECURRICULAR PRIMARY KEY (GRC_ID);
ALTER TABLE HORARIOS ADD CONSTRAINT PK_HORARIOS PRIMARY KEY (HOR_CODIGO);
ALTER TABLE PESSOAS ADD CONSTRAINT PK_PESSOAS PRIMARY KEY (PES_CPFCNPJ);
ALTER TABLE PROFESSOR_HORARIO ADD CONSTRAINT PK_PROFESSORHORARIO PRIMARY KEY (PFH_ID);
ALTER TABLE SERIES ADD CONSTRAINT PK_SERIES PRIMARY KEY (SER_ANO);


/******************************************************************************/
/***                              Foreign Keys                              ***/
/******************************************************************************/

ALTER TABLE ACADEMICO_GRADE ADD CONSTRAINT FK_ACADGRADE_GRADECURRICULAR FOREIGN KEY (ACG_GRADE) REFERENCES GRADE_CURRICULAR (GRC_ID);
ALTER TABLE ACADEMICO_GRADE ADD CONSTRAINT FK_ACADGRADE_PESSOAS FOREIGN KEY (ACG_ACADEMICO) REFERENCES PESSOAS (PES_CPFCNPJ);
ALTER TABLE CURSOS ADD CONSTRAINT FK_CURSOS_DEPARTAMENTOS FOREIGN KEY (CUR_DEPARTAMENTO) REFERENCES DEPARTAMENTOS (DEP_CODIGO);
ALTER TABLE GRADE_CURRICULAR ADD CONSTRAINT FK_GRADECURRICULAR_CURSOS FOREIGN KEY (GRC_CURSO) REFERENCES CURSOS (CUR_CODIGO);
ALTER TABLE GRADE_CURRICULAR ADD CONSTRAINT FK_GRADECURRICULAR_DISCIPLINA FOREIGN KEY (GRC_DISCIPLINA) REFERENCES DISCIPLINAS (DIS_CODIGO);
ALTER TABLE GRADE_CURRICULAR ADD CONSTRAINT FK_GRADECURRICULAR_DTVIGENCIA FOREIGN KEY (GRC_DATAVIGENCIA) REFERENCES DATA_VIGENCIA (DVG_ID);
ALTER TABLE GRADE_CURRICULAR ADD CONSTRAINT FK_GRADECURRICULAR_SERIE FOREIGN KEY (GRC_SERIE) REFERENCES SERIES (SER_ANO);
ALTER TABLE PROFESSOR_HORARIO ADD CONSTRAINT FK_PROFHORARIO_GRADECURRICULAR FOREIGN KEY (PFH_GRADE) REFERENCES GRADE_CURRICULAR (GRC_ID);
ALTER TABLE PROFESSOR_HORARIO ADD CONSTRAINT FK_PROFHORARIO_HORARIO FOREIGN KEY (PFH_HORARIO) REFERENCES HORARIOS (HOR_CODIGO);
ALTER TABLE PROFESSOR_HORARIO ADD CONSTRAINT FK_PROFHORARIO_PESSOAS FOREIGN KEY (PFH_PROFESSOR) REFERENCES PESSOAS (PES_CPFCNPJ);
